<app-page-title title="{{'tests.subtitle' | translate}}" subTitle="{{'tests.test-type-data' | translate}}">
</app-page-title>

<app-loading-spinner *ngIf="isLoading" [contentHeight]="'80vh'" [height]="'5rem'" [width]="'5rem'"
    [colorClass]="'text-primary'">
</app-loading-spinner>

<erp-shared-content *ngIf="!isLoading">
    <div class="card card-custom gutter-b">
        <div class="card-body p-0">
            <div class="wizard wizard-1" id="kt_contact_add" data-wizard-state="step-first"
                data-wizard-clickable="true">
                <div class="row justify-content-center my-10 px-8 my-lg-15 px-lg-10">
                    <div class="col-xl-12 col-xxl-7">
                        <div class="form" id="kt_contact_add_form" [formGroup]="testForm">
                            <div class="pb-5" data-wizard-type="step-content" data-wizard-state="current">
                                <h3 class="mb-10 font-weight-bold text-dark">{{'tests.test-type-details' |
                                    translate}}</h3>
                                <div class="row">
                                    <div class="col-xl-12">
                                        <div class="form-group row">
                                            <label class="col-xl-3 col-lg-3 col-form-label text-right">
                                                {{'tests.mode' | translate}}
                                            </label>
                                            <div class="col-lg-9 col-xl-9">
                                                <select (ngModelChange)="onChange($event)"
                                                    [formControl]="testForm.controls['mode']" name="mode"
                                                    class="form-control form-control-solid">
                                                    <option *ngFor="let item of modes" [value]="item.value">
                                                        {{'statuses.' + item.label | translate}}</option>
                                                </select>
                                            </div>
                                        </div>
                                        <!-- <div class="form-group row" *ngIf="modeId == 2 || modeId == 0 || modeId == null">
                                            <label class="col-xl-3 col-lg-3 col-form-label text-right">Tip calificativ</label>
                                            <div class="col-lg-9 col-xl-9">
                                              <select [formControl]="testForm.controls['qualification']" name="qualification" class="form-control form-control-solid">
                                                <option *ngFor="let item of testTemplateQualifications" [value]="item.value">{{item.label}}</option>
                                              </select>
                                            </div>
                                        </div> -->
                                        <div class="form-group row">
                                            <label class="col-xl-3 col-lg-3 col-form-label text-right">
                                                {{'tests.name'| translate}}</label>
                                            <div class="col-lg-9 col-xl-9">
                                                <input class="form-control form-control-solid" name="name"
                                                    type="text" formControlName="name"
                                                    placeholder="{{'verify-test.test-type-name' | translate}}" />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label
                                                class="col-xl-3 col-lg-3 col-form-label text-right">
                                                {{'categories.total-questions'| translate}}
                                            </label>
                                            <div class="col-lg-9 col-xl-9">
                                                <input class="form-control form-control-solid"
                                                    name="questionCount" type="number"
                                                    formControlName="questionCount" min="1" placeholder="0" />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-xl-3 col-lg-3 col-form-label text-right">
                                                {{'faq.module-roles' | translate}}
                                            </label>
                                            <div class="col-lg-9 col-xl-9">
                                                <tag-input
                                                class="py-0 px-2 form-control form-control-lg form-control-solid h-100"
                                                [ngModelOptions]="{standalone: true}" [(ngModel)]="tags"
                                                [placeholder]="placeHolder"
                                                [secondaryPlaceholder]="placeHolder">
                                                <tag-input-dropdown [autocompleteItems]="items"
                                                    [showDropdownIfEmpty]="true" [keepOpen]="true"
                                                    [dynamicUpdate]="true">
                                                </tag-input-dropdown>
                                            </tag-input>
                                            </div>
                                            <label class="col-xl-3 col-lg-3"></label>
                                            <div class="col-lg-9 col-xl-9 text-muted">{{ 'test-template.info-tag' | translate }}</div>
                                        </div>
                                        <div *ngIf="modeId == 0 || modeId == null" class="form-group row">
                                            <label
                                                class="col-xl-3 col-lg-3 col-form-label text-right">{{'tests.total-time'
                                                | translate}} ({{'tests.minutes' | translate}})</label>
                                            <div class="col-lg-9 col-xl-9">
                                                <input class="form-control form-control-solid" name="duration"
                                                    type="number" formControlName="duration" min="1"
                                                    placeholder="0 minutes" />
                                            </div>
                                        </div>
                                        <div *ngIf="modeId == 0 || modeId == null" class="form-group row">
                                            <label
                                                class="col-xl-3 col-lg-3 col-form-label text-right">{{'tests.min-percentage'
                                                | translate}}</label>
                                            <div class="col-lg-9 col-xl-9">
                                                <input class="form-control form-control-solid" name="minPercent"
                                                    type="number" formControlName="minPercent" min="1"
                                                    placeholder="0" />
                                            </div>
                                        </div>
                                        <div *ngIf="modeId == 2" class="form-group row">
                                            <label class="col-xl-3 col-lg-3 col-form-label text-right">{{'test-template.qualifying-type' | translate}}</label>
                                            <div class="col-lg-9 col-xl-9">
                                              <select [formControl]="testForm.controls['qualifyingType']" name="qualifyingType" class="form-control form-control-solid">
                                                <option *ngFor="let item of qualifyingTypesWithout15" [value]="item.value">{{'statuses.' + item.label | translate}}</option>
                                              </select>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label class="col-xl-3 col-lg-3 col-form-label text-right">{{'tests.basic-template-dropdown.title' | translate}}</label>
                                            <div class="col-lg-9 col-xl-9">
                                                <select class="form-control form-control-solid" formControlName="basicTestTemplate">
                                                    <option [value]="null">{{ 'tests.basic-template-dropdown.0' | translate }}</option>
                                                    <option [value]="basicTemplateEnum.GeneralTraining">{{ 'tests.basic-template-dropdown.1' | translate }}</option>
                                                    <option [value]="basicTemplateEnum.SpecializedTraining">{{ 'tests.basic-template-dropdown.2' | translate }}</option>
                                                    <option [value]="basicTemplateEnum.ShootingInstruction">{{ 'tests.basic-template-dropdown.3' | translate }}</option>
                                                    <option [value]="basicTemplateEnum.ProfessionalIntervention">{{ 'tests.basic-template-dropdown.4' | translate }}</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="text-right border-top pt-10">
                                <app-button class="btn mr-2" [value]="'button.cancel' | translate"
                                    (handle)="backClicked()"></app-button>
                                <app-add-button class="btn" *ngIf="!testId" [disabled]="testForm.invalid"
                                    (handle)="onSave()" [value]="'button.confirm' | translate"></app-add-button>
                                <app-confirm-button class="btn" *ngIf="testId" [disabled]="testForm.invalid"
                                    (handle)="onSave()" [value]="'button.update' | translate">
                                </app-confirm-button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</erp-shared-content>
