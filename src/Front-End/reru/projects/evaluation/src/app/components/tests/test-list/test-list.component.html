<app-page-title title="{{ 'verify-test.title' | translate }}" subTitle="{{ 'verify-test.subtitle' | translate }}">
</app-page-title>

<div class="content d-flex flex-column flex-column-fluid" id="kt_content">
  <div class="d-flex flex-column-fluid">
    <div class="container">
      <div class="row">
        <div class="col">
          <div class="card card-custom gutter-b">
            <div class="card-header flex-wrap border-0 py-5">
              <div class="card-title">
                <h3 class="card-label" id="title">
                  {{ "verify-test.title" | translate }}
                </h3>
              </div>
              <div class="card-toolbar">
                <button class="btn btn-light-warning font-weight-bold mr-3" (click)="openHistoryModal()">
                  <i class="far fa-file-excel"></i>
                  {{ 'processes.history' | translate }}
                </button>
                <app-confirm-button class="btn mr-3" (click)="testsTable.getHeaders(getTitle())">
                  <i class="far fa-file-pdf text-white"></i>
                  {{ "button.print" | translate }}
                </app-confirm-button>
                <app-add-button class="btn my-auto mr-5" [routerLink]="['add-test']"
                  [value]="'tests.new-test' | translate"></app-add-button>
              </div>
            </div>
            <div class="card-header border-0 pt-0 pb-0 pr-5" style="min-height: 100%">
              <div class="row w-100">
                <div class="col">
                  <erp-shared-search-input (handleSearch)="testsTable.setFilter('testName', $event)"
                    [placeholder]="'button.search-name' | translate" #testName></erp-shared-search-input>
                </div>
                <div class="col">
                  <erp-shared-search-input (handleSearch)="testsTable.setFilter('testEvent', $event)"
                    [placeholder]="'events.search-event' | translate" #testEvent></erp-shared-search-input>
                </div>
                <div class="col">
                  <erp-shared-search-input (handleSearch)="
                      testsTable.setFilter('testLocation', $event)
                    " [placeholder]="'events.search-location' | translate" #testLocation></erp-shared-search-input>
                </div>
                <div class="col">
                  <erp-shared-search-input (handleSearch)="testsTable.setFilter('userName', $event)"
                    [placeholder]="'verify-test.search-student' | translate" #userName></erp-shared-search-input>
                </div>
                <div class="col">
                  <erp-shared-search-input (handleSearch)="testsTable.setFilter('userEmail', $event)"
                    [placeholder]="'verify-test.search-email' | translate" #userEmail></erp-shared-search-input>
                </div>
              </div>
              <div class="row w-100 mt-3">
                <div class="col-lg-2 col-12">
                  <app-search-status (filter)="testsTable.setFilter('selectedStatus', $event)" #selectedStatus>
                  </app-search-status>
                </div>
                <div class="col-lg-2 col-12">
                  <app-search-result (filter)="testsTable.setFilter('selectedResult', $event)" #selectedResult>
                  </app-search-result>
                </div>
                <div class="col-lg-2 col-12">
                  <erp-shared-search-input (handleSearch)="testsTable.setFilter('idnp', $event)"
                    [placeholder]="'verify-test.search-student-idnp' | translate" #idnp></erp-shared-search-input>
                </div>
                <div class="col-lg-2 col-12">
                  <div class="input-group input-group-sm input-group-solid">
                    <input id="from" [owlDateTime]="dtFrom" [placeholder]="'events.search-from' | translate"
                      class="shadow-input" name="date" [(ngModel)]="testsTable.dateTimeFrom"
                      (ngModelChange)="testsTable.getTests({dtFrom: $event})" autocomplete="off" />
                    <input id="from" [owlDateTimeTrigger]="dtFrom" [placeholder]="'events.search-from' | translate"
                      autocomplete="off" class="form-control form-control-lg form-control-solid"
                      [value]="testsTable.dateTimeFrom | dateFilter:'dd/MM/yy HH:mm'" />
                    <owl-date-time #dtFrom></owl-date-time>
                  </div>
                </div>
                <div class="col-lg-2 col-12">
                  <div class="input-group input-group-sm input-group-solid">
                    <input id="from" [owlDateTime]="toDate" [placeholder]="'events.search-to' | translate"
                      class="shadow-input" name="date" [(ngModel)]="testsTable.dateTimeTo"
                      (ngModelChange)="testsTable.getTests({toDate: $event})" autocomplete="off" />
                    <input id="from" [owlDateTimeTrigger]="toDate" [placeholder]="'events.search-to' | translate"
                      autocomplete="off" class="form-control form-control-lg form-control-solid"
                      [value]="testsTable.dateTimeTo | dateFilter:'dd/MM/yy HH:mm'" />
                    <owl-date-time #toDate></owl-date-time>
                  </div>
                </div>
                <div class="col-lg-2 col-12">
                  <app-search-department (filter)="testsTable.setFilter('departmentId',  $event)" #departmentId></app-search-department>
                </div>
              </div>
              <div class="row w-100 mt-3">
                
                <div class="col-lg-2 col-12">
                  <app-search-role (filter)="testsTable.setFilter('roleId',  $event)" #roleId></app-search-role>
                </div>
                <div class="col">
                  <div class="text-right">
                    <app-button (handle)="clearFields(); testsTable.resetFilters()" [value]="'button.reset' | translate"
                      class="mr-5"></app-button>
                    <app-confirm-button (handle)="testsTable.getTests({ page: 1 })"
                      [value]="'button.search' | translate">
                    </app-confirm-button>
                  </div>
                </div>
              </div>
            </div>
            <div class="card-body">
              <app-test-list-table #testsTable></app-test-list-table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>