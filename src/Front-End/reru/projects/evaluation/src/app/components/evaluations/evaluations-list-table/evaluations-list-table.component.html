<app-page-title title="{{'evaluations.evaluations' | translate}}" subTitle="{{'evaluations.manage-evaluations' | translate}}">
</app-page-title>

<erp-shared-content>
    <div class="d-flex flex-row">
        <div class="col">
            <div class="card card-custom gutter-b erp-shared-desktop-wide">
                <div class="card-header flex-wrap border-0 py-5">
                    <div class="card-title">
                        <h3 class="card-label" id="title">{{'evaluations.evaluations' | translate}} </h3>
                    </div>
                    <div class="card-toolbar d-md-flex d-none">
                        <erp-shared-export-button class="mr-3" (click)="testsTable.getHeaders(getTitle())">
                            {{'button.export' | translate}}
                        </erp-shared-export-button>
                        <app-add-button class="btn" [value]="'evaluations.add-evaluation' | translate" [routerLink]="['add']" ></app-add-button>
                    </div>
                    <div class="card-toolbar d-md-none d-flex flex-column w-100">
                        <erp-shared-export-button class="w-100" width="100%" (click)="testsTable.getHeaders(getTitle())">
                            {{'button.export' | translate}}
                        </erp-shared-export-button>
                        <app-add-button class="btn my-auto w-100 pt-2" width="100%" [value]="'evaluations.add-evaluation' | translate" [routerLink]="['add']" ></app-add-button>
                    </div>
                </div>
                <!-- <div class="card-body"> -->
                    <div class="card-header border-0 pt-0 pb-0 pr-1" *ngIf="this.showFilter">
                        <div class="row w-100">
                            <div class="col-lg col-md-6 col-12 pt-md-0 pt-2"> 
                                <erp-shared-search-input [useDebounce]="false" [showIcon]="false" (handleSearch)="testsTable.filters.testName=$event"
                                    [placeholder]="'button.search-name' | translate" #testName>
                                </erp-shared-search-input>
                            </div>
                            <div class="col-lg col-md-6 col-12 pt-lg-0 pt-2"> 
                                <erp-shared-search-input [useDebounce]="false" [showIcon]="false" (handleSearch)="testsTable.filters.userName=$event"
                                    [placeholder]="'verify-test.search-student' | translate" #userName>
                                </erp-shared-search-input>
                            </div>
                            <div class="col-lg col-md-6 col-12 pt-lg-0 pt-2"> 
                                <erp-shared-search-input [useDebounce]="false" [showIcon]="false" (handleSearch)="testsTable.filters.evaluatorName=$event"
                                    [placeholder]="'evaluations.search-evaluator' | translate" #evaluatorName>
                                </erp-shared-search-input>
                            </div>
                            <div class="col-lg col-md-6 col-12 pt-lg-0 pt-2"> 
                                <erp-shared-search-input [useDebounce]="false" [showIcon]="false" (handleSearch)="testsTable.filters.testEvent=$event"
                                    [placeholder]="'events.search-event' | translate" #testEvent>
                                </erp-shared-search-input>
                            </div>
                        </div>
                        <div class="row w-100 mt-lg-3 mt-0">
                            <div class="col-lg col-md-6 col-12 pt-lg-0 pt-2"> 
                                <erp-shared-search-input [useDebounce]="false" [showIcon]="false" (handleSearch)="testsTable.filters.testLocation=$event"
                                    [placeholder]="'events.search-location' | translate" #testLocation>
                                </erp-shared-search-input>
                            </div>
                            <div class="col-lg col-md-6 col-12 pt-lg-0 pt-2">
                                <app-search-result (filter)="testsTable.setFilter('selectedResult', $event)" #selectedResult>
                                </app-search-result>
                            </div>
                            <div class="col-lg col-md-6 col-12 pt-lg-0 pt-2">
                                <div class="input-group input-group-sm input-group-solid">
                                    <input id="from" [owlDateTime]="dtFrom" [placeholder]="'events.search-from' | translate"
                                        class="shadow-input" name="date" [(ngModel)]="testsTable.dateTimeFrom" autocomplete="off" />
                                    <input id="from" [owlDateTimeTrigger]="dtFrom" [placeholder]="'events.search-from' | translate"
                                        autocomplete="off" class="form-control form-control-lg form-control-solid"
                                        [value]="testsTable.dateTimeFrom | dateFilter:'dd/MM/yy HH:mm'" />
                                        <i class="fas fa-calendar-alt mr-2"></i>
                                    <owl-date-time #dtFrom></owl-date-time>
                                </div>
                            </div>
                            <div class="col-lg col-md-6 col-12 pt-lg-0 pt-2">
                                <div class="input-group input-group-sm input-group-solid">
                                    <input id="from" [owlDateTime]="toDate" [placeholder]="'events.search-to' | translate"
                                        class="shadow-input" name="date" [(ngModel)]="testsTable.dateTimeTo" autocomplete="off" />
                                    <input id="from" [owlDateTimeTrigger]="toDate" [placeholder]="'events.search-to' | translate"
                                        autocomplete="off" class="form-control form-control-lg form-control-solid"
                                        [value]="testsTable.dateTimeTo | dateFilter:'dd/MM/yy HH:mm'" />
                                        <i class="fas fa-calendar-alt mr-2"></i>
                                    <owl-date-time #toDate></owl-date-time>
                                </div>
                            </div>
                        </div>
                        <div class="row w-100 mt-lg-3 mt-0">
                            <div class="col-lg col-md-6 col-12 pt-lg-0 pt-2">
                                <app-search-department (filter)="testsTable.setFilter('departmentId',  $event)" #departmentId></app-search-department>
                            </div>
                            <div class="col-lg col-md-6 col-12 pt-lg-0 pt-2">
                                <app-search-role (filter)="testsTable.setFilter('roleId',  $event)" #roleId></app-search-role>
                            </div>
                            <div class="col-lg col-md-6 col-12 pt-lg-0 pt-2">
                                <app-search-employee-function (filter)="testsTable.setFilter('functionId',  $event)" #functionId></app-search-employee-function>
                             </div>
                            <div class="col-auto d-lg-block d-none pt-lg-0 pt-2">
                                <div class="text-right">
                                    <app-button (handle)="clearFields(); testsTable.resetFilters(); testsTable.getTests({ page: 1 })" [value]="'button.reset' | translate"
                                        class="mr-5"></app-button>
                                    <app-confirm-button (handle)="testsTable.getTests({ page: 1 })" [value]="'button.search' | translate">
                                    </app-confirm-button>
                                </div>
                            </div>
                            <div class="col-lg offset-lg-0 offset-md-6 col-md-6 d-lg-none d-md-block d-none pt-lg-0 pt-2">
                                <div class="text-right">
                                    <app-button (handle)="clearFields(); testsTable.resetFilters(); testsTable.getTests({ page: 1 })" [value]="'button.reset' | translate"
                                        class="mr-5"></app-button>
                                    <app-confirm-button (handle)="testsTable.getTests({ page: 1 })" [value]="'button.search' | translate">
                                    </app-confirm-button>
                                </div>
                            </div>
                            <div class="col-12 d-md-none d-block pt-lg-0 pt-2">
                                <div class="d-flex flex-column">
                                    <app-confirm-button class="w-100" [width]="'100%'" (handle)="testsTable.getTests({ page: 1 })" [value]="'button.search' | translate"></app-confirm-button>
                                    <app-button (handle)="clearFields(); testsTable.resetFilters(); testsTable.getTests({ page: 1 })" [value]="'button.reset' | translate"
                                        class="mt-2" width="100%"></app-button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <app-evaluations-table #testsTable></app-evaluations-table>
                    </div>
                <!-- </div> -->
            </div>
        </div>
    </div>
</erp-shared-content>
