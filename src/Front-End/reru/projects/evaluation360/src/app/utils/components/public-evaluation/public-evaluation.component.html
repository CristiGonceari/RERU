<div class="d-flex flex-column-fluid" *ngIf="evaluation">
    <div class="container">
      <div class="card card-custom gutter-b">
        <div class="card-body p-0">
          <div class="wizard wizard-1">
            <div class="row my-5 px-8 my-lg-7 px-lg-10">
              <div class="d-flex align-items-center justify-content-between mb-2">
                <span class="mr-2">Subdiviziunea:</span>
                <span class="font-weight-bold">{{ evaluation.evaluatorUserOrganizationName }}</span>
              </div>
            </div>
  
            <div class="row my-5 px-8 my-lg-7 px-lg-10">
                <h2>FIŞĂ DE EVALUARE a <b *ngIf="type === 2">funcționarului public de conducere</b><b *ngIf="type === 1">funcționarului public de executie</b></h2>
            </div>
            
            <div class="col">
              <form [formGroup]="surveyForm">
                <div class="form-group row">
                  <div class="col card">
                    <div class="row my-5 px-8 my-lg-7 px-lg-10">
                      <h3>1. Date generale ale angajatului evaluat</h3>
                    </div>
                    <div class="row my-5 px-8 my-lg-7 px-lg-10">
                      <div class="d-flex justify-content-between mb-2">
                      <span class="mr-2">Numele, prenumele a persoanei evaluate:</span>
                      <span class="font-weight-bold">{{ evaluation.evaluatedUserName }}
                        {{ evaluation.evaluatedUserLastName }}</span>
                      </div>
                    </div>
  
                    <div class="row my-5 px-8 my-lg-7 px-lg-10">
                      <div class="d-flex justify-content-between mb-2">
                      <span class="mr-2">Funcția, departamentul:</span>
                      <span class="font-weight-bold">{{ evaluation.evaluatedUserPositionName }},
                        {{ evaluation.evaluatedUserDepartmentName }}</span>
                      </div>
                    </div>
  
                    <hr />
  
                    <div class="row my-5 px-8 my-lg-7 px-lg-10">
                      <div class="col">
                      <label class="col-form-label">Perioada evaluată</label>
                      </div>
                      <div class="col">
                      <div class="row">
                        <label for="" class="col-4 col-form-label">de la</label>
                        <div class="col">
                        <app-date [parent]="surveyForm" [date]="'evaluationFromDate'"></app-date>
                        </div>
                      </div>
                      </div>
                      <div class="col">
                      <div class="row">
                        <label for="" class="col-4 col-form-label">până la</label>
                        <div class="col">
                        <app-date [parent]="surveyForm" [date]="'evaluationToDate'"></app-date>
                        </div>
                      </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10">
                  <div class="col">
                    <h5>Activităţi de instruire de bază la care a participat funcționarul public (tematica)</h5>
                  </div>
                </div>
  
                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10">
                  <div class="col-12">
                    <label for="specializationCoursesInternal" class="col-form-label">Rezultatele evaluării pe parcursul anului (după caz)</label>
                  </div>
                </div>
  
                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10" [ngClass]="{'required-group': isEditable('specializationCoursesInternal'), 'required-label': isRequired('specializationCoursesInternal') }">
                  <div class="col-xl-4 col-12 mt-xl-0 mt-3">
                    <div class="row no-gutters mx-4">
                      <label for="specializationCoursesInternal" class="col col-form-label">interne: </label>
                      <div class="col">
                        <input class="form-control" type="number" formControlName="specializationCoursesInternal"
                          name="specializationCoursesInternal" id="specializationCoursesInternal" placeholder="0">
                      </div>
                    </div>
                  </div>
                  <div class="col-xl-4 col-12 mt-xl-0 mt-3">
                    <div class="row no-gutters mx-4" [ngClass]="{'required-group': isEditable('specializationCoursesInternational'), 'required-label': isRequired('specializationCoursesInternational') }">
                      <label for="" class="col col-form-label">internationale: </label>
                      <div class="col">
                        <input class="form-control" type="number" formControlName="specializationCoursesInternational"
                          name="specializationCoursesInternational" id="specializationCoursesInternational" placeholder="0">
                      </div>
                    </div>
                  </div>
                  <div class="col-xl-4 col-12 mt-xl-0 mt-3">
                    <div class="row no-gutters mx-4" [ngClass]="{'required-group': isEditable('specializationCoursesOthers'), 'required-label': isRequired('specializationCoursesOthers') }">
                      <label for="" class="col col-form-label">altele: </label>
                      <div class="col">
                        <input class="form-control" type="number" formControlName="specializationCoursesOthers"
                          name="specializationCoursesOthers" id="specializationCoursesOthers" placeholder="0">
                      </div>
                    </div>
                  </div>
                </div>

                <hr />

                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10">
                  <div class="col-12">
                    <label for="" class="col-form-label"> Rezultatele evaluării pe parcursul anului (după caz): </label>
                  </div>
                </div>
                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10">
                  <div class="col">
                    <div class="row align-items-center" [ngClass]="{'required-label': isRequired('partialEvaluationFromDate') }">
                      <label for="partialEvaluationFromDate" class="col-1 col-form-label">Perioada: </label>
                      <div class="col-5">
                        <app-date [parent]="surveyForm" [date]="'partialEvaluationFromDate'"></app-date> 
                      </div>
                      <div class="col-1 text-center"> - </div>
                      <div class="col-5"><app-date [parent]="surveyForm" [date]="'partialEvaluationToDate'"></app-date></div>
                    </div>
                  </div>
                </div>
  
                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10">
                  <div class="col-6">
                    <div class="row" [ngClass]="{'required-group': isEditable('partialEvaluationRate'), 'required-label': isRequired('partialEvaluationRate') }">
                      <label for="partialEvaluationRate" class="col-2 col-form-label">Punctaj:</label>
                    <div class="col">
                      <input class="form-control" type="number" formControlName="partialEvaluationRate"
                        name="partialEvaluationRate" id="partialEvaluationRate" />
                    </div>
                    </div>
                  </div>
  
                  <div class="col-6">
                    <div class="row" [ngClass]="{'required-group': isEditable('partialEvaluationMark'), 'required-label': isRequired('partialEvaluationMark') }">
                      <label for="partialEvaluationMark" class="col-auto col-form-label">Calificativ: </label>
                      <div class="col">
                        <select class="form-control w-100" formControlName="partialEvaluationMark" name="partialEvaluationMark"
                          id="partialEvaluationMark">
                          <option value="null">Selectează</option>
                          <option value="1">Foarte bine</option>
                          <option value="2">Bine</option>
                          <option value="3">Satisfacator</option>
                          <option value="4">Nesatisfacator</option>
                        </select>
                      </div>
                    </div>
                  </div>
  
                </div>
                <hr />
  
                <div class="row my-5 px-8 my-lg-7 px-lg-10">
                  <h3>2. Evaluarea îndeplinirii obiectivelor individuale de activitate</h3>
                </div>

                <hr>
  
                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10">
                  <div class="col card">
                    <table class="table">
                      <thead>
                        <th>Nr. crt.</th>
                        <th>Obiective individuale de activitate</th>
                        <th>Indicatori de performanță</th>
                        <th>Nivel de îndeplinire, în %</th>
                        <th>Comentarii</th>
                        <th>Punctaj stabilit</th>
                      </thead>
                      <tbody>
                        <tr *ngFor="let item of objectives; let i = index">
                          <td><b>{{ i + 1 }}.</b></td>
                          <td [ngClass]="{'required-group': isEditable('objective'+item+'Name'), 'required-label': isRequired('objective'+item+'Name') }">
                            <input type="text" class="form-control" [formControlName]="'objective'+item+'Name'" placeholder="Obiectiv">
                          </td>
                          <td [ngClass]="{'required-group': isEditable('objective'+item+'Performance'), 'required-label': isRequired('objective'+item+'Performance') }">
                            <input type="text" class="form-control" [formControlName]="'objective'+item+'Performance'" placeholder="Indicator de performmanță">
                          </td>
                          <td [ngClass]="{'required-group': isEditable('objective'+item+'Complete'), 'required-label': isRequired('objective'+item+'Complete') }">
                            <input type="number" class="form-control" [formControlName]="'objective'+item+'Complete'" placeholder="0">
                          </td>
                          <td [ngClass]="{'required-group': isEditable('objective'+item+'Comments'), 'required-label': isRequired('objective'+item+'Comments') }">
                            <input type="text" class="form-control" [formControlName]="'objective'+item+'Comments'" placeholder="Comentarii">
                          </td>
                          <td [ngClass]="{'required-group': isEditable('objective'+item+'Mark'), 'required-label': isRequired('objective'+item+'Mark') }">
                            <input type="number" class="form-control" [formControlName]="'objective'+item+'Mark'" placeholder="Notă">
                          </td>
                        </tr>
                        <tr>
                          <td colspan="4"></td>
                          <td><b>Media aritmetică:</b></td>
                          <td>{{ calculateObjectiveMedia() | number : '1.1-2' }}</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>

                <hr>
                <div class="row my-5 px-8 my-lg-7 px-lg-10">
                  <h3>3. Aprecierea nivelului de manifestare a criteriilor de evaluare</h3>
                </div>

                <hr>

                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10">
                  <div class="col card">
                    <table class="table">
                      <thead>
                        <th>Nr. crt.</th>
                        <th>Criterii de evaluare</th>
                        <th>Punctaj stabilit</th>
                        <th>Comentarii</th>
                      </thead>
                      <tbody>
                        <tr *ngFor="let item of criterias; let i = index">
                          <td class="align-middle"><b>{{ i + 1 }}.</b></td>
                          <td class="align-middle">{{ item }}</td>
                          <td [ngClass]="{'required-group': isEditable('question'+(i + 1)+'Mark'), 'required-label': isRequired('question'+(i + 1)+'Mark') }">
                            <input type="number" class="form-control" [formControlName]="'question'+(i + 1)+'Mark'" placeholder="0">
                          </td>
                          <td [ngClass]="{'required-group': isEditable('question'+(i + 1)+'Comments'), 'required-label': isRequired('question'+(i + 1)+'Comments') }">
                            <input type="text" class="form-control" [formControlName]="'question'+(i + 1)+'Comments'" placeholder="Comentarii">
                          </td>
                        </tr>
                        <tr>
                          <td colspan="2"></td>
                          <td><b>Media aritmetică:</b></td>
                          <td>{{ calculateQuestionMedia() | number : '1.1-2' }}</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>

                <hr>

                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10">
                  <label for="points" class="col col-form-label">Punctaj final calculat din suma mediei aritmetice obținută 
                    la evaluarea îndelinirii obiectivelor (pct 2 din prezentă anexa) și mediei aritmetice obținută la aprecierea 
                    nivelului de manifestare a celor 6 criterii de evaluare (pct. 3 din prezenta anexă), împărțit la doi</label>
                  <div class="col-2">
                    <input type="number" class="form-control" readonly="true" id="points" placeholder="0" [value]="calculateMedias() | number: '1.1-2'">
                  </div>
                </div>

                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10" [ngClass]="{'required-group': isEditable('finalMark'), 'required-label': isRequired('finalMark') }">
                  <label for="finalMark" class="col col-form-label"><h3>4. Calificativul de evaluare</h3></label>
                  <div class="col">
                    <select class="form-control w-100" formControlName="finalMark" name="finalMark" id="finalMark">
                      <option value="null">Selectează</option>
                      <option value="4">{{'evaluations.qualificatives.qualificative-4' | translate}}</option>
                      <option value="3">{{'evaluations.qualificatives.qualificative-3' | translate}}</option>
                      <option value="2">{{'evaluations.qualificatives.qualificative-2' | translate}}</option>
                      <option value="1">{{'evaluations.qualificatives.qualificative-1' | translate}}</option>
                    </select>
                  </div>
                </div>

                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10" [ngClass]="{'required-group': isEditable('comments'), 'required-label': isRequired('comments') }">
                  <label for="comments" class="col col-form-label"><h3>5. Comentariile evaluatorului privind rezultatele evaluării funcționarului public</h3></label>
                  <div class="col">
                    <textarea class="form-control" formControlName="comments" name="comments" id="comments" cols="30" rows="3" placeholder="Comentarii"></textarea>
                  </div>
                </div>

                <hr>
                <div class="row my-5 px-8 my-lg-7 px-lg-10">
                  <h3>6. Necesități de dezvoltare profesională a funcționarului evaluat</h3>
                </div>
                <hr>

                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10">
                  <div class="col card">
                    <table class="table">
                      <thead>
                        <th>Cunoștințe</th>
                        <th>Abilități profesionale</th>
                        <th>Comportament și atitudini</th>
                      </thead>
                      <tbody>
                        <tr>
                          <td [ngClass]="{'required-group': isEditable('needImprovement1'), 'required-label': isRequired('needImprovement1') }">
                            <textarea placeholder="Cunoștințe" class="form-control" name="needImprovement1" id="needImprovement1" cols="30" rows="10" formControlName="needImprovement1"></textarea>
                          </td>
                          <td [ngClass]="{'required-group': isEditable('needImprovement2'), 'required-label': isRequired('needImprovement2') }">
                            <textarea placeholder="Abilități profesionale" class="form-control" name="needImprovement2" id="needImprovement2" cols="30" rows="10" formControlName="needImprovement2"></textarea>
                          </td>
                          <td [ngClass]="{'required-group': isEditable('needImprovement3'), 'required-label': isRequired('needImprovement3') }">
                            <textarea placeholder="Comportament și atitudini" class="form-control" name="needImprovement3" id="needImprovement3" cols="30" rows="10" formControlName="needImprovement3"></textarea>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>

                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10" [ngClass]="{'required-group': isEditable('evaluatedComments'), 'required-label': isRequired('evaluatedComments') }">
                  <label for="evaluatedComments" class="col col-form-label"><h3>7. Comentariile funcționarului public evaluat</h3></label>
                </div>

                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10" [ngClass]="{'required-group': isEditable('evaluatedComments'), 'required-label': isRequired('evaluatedComments') }">
                  <div class="col">
                    <textarea class="form-control" formControlName="evaluatedComments" name="evaluatedComments" id="evaluatedComments" cols="30" rows="2" placeholder="Comentariile funcționarului public evaluat"></textarea>
                  </div>
                </div>

                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10" [ngClass]="{'required-group': isEditable('evaluatedComments'), 'required-label': isRequired('evaluatedComments') }">
                  <label for="counterSingerComments" class="col col-form-label"><h3> 8. Comentariile contrasemnatarului</h3></label>
                </div>

                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10" [ngClass]="{'required-group': isEditable('counterSingerComments'), 'required-label': isRequired('counterSingerComments') }">
                  <div class="col">
                    <textarea class="form-control" formControlName="counterSingerComments" name="counterSingerComments" id="counterSingerComments" cols="30" rows="2" placeholder="Comentariile contrasemnatarului"></textarea>
                  </div>
                </div>

                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10" *ngIf="action == 2">
                  <div class="col d-flex justify-content-center">
                    <button type="button" class="btn btn-secondary mr-2" (click)="acceptEvaluation(0)">Salveaza fără acceptare</button>
                    <button type="button" class="btn btn-primary mr-2" [disabled]="surveyForm.invalid" (click)="acceptEvaluation(1)">Acceptă</button>
                    <button type="button" class="btn btn-danger" [disabled]="surveyForm.invalid" (click)="acceptEvaluation(2)">Refuză</button>
                  </div>
                </div>
  
                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10" *ngIf="action == 1">
                  <div class="col d-flex justify-content-center">
                    <button type="button" class="btn btn-secondary mr-2" (click)="submit(false)">Salveaza fără acceptare</button>
                    <button type="button" class="btn btn-primary" [disabled]="surveyForm.invalid" (click)="submit(true)">Evaluează</button>
                  </div>
                </div>

                <div class="form-group row my-5 px-8 my-lg-7 px-lg-10" *ngIf="action == 3">
                  <div class="col d-flex justify-content-center">
                    <button type="button" class="btn btn-primary mr-2" (click)="counterSignEvaluation(1)">Acceptă</button>
                    <button type="button" class="btn btn-danger" (click)="counterSignEvaluation(2)">Refuză</button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  