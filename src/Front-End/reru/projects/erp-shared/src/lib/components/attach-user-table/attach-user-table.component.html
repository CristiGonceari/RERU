<div *ngIf="showFilters" class="row mb-lg-4 mb-0">
    <div class="col-lg col-12">
        <erp-shared-search-input (handleSearch)="setFilter('lastName', $event)"
            [placeholder]="'attach-user-modal.last-name' | translate"></erp-shared-search-input>
    </div>
    <div class="col-lg col-12 pt-lg-0 pt-2">
        <erp-shared-search-input (handleSearch)="setFilter('firstName', $event)"
            [placeholder]="'attach-user-modal.first-name' | translate"></erp-shared-search-input>
    </div>
    <div class="col-lg col-12 pt-lg-0 pt-2">
        <erp-shared-search-input (handleSearch)="setFilter('fatherName', $event)"
        [placeholder]="'attach-user-modal.father-name' | translate"></erp-shared-search-input>
    </div>
    <div class="col-lg col-12 pt-lg-0 pt-2">
        <erp-shared-search-input (handleSearch)="setFilter('idnp', $event)"
            [placeholder]="'attach-user-modal.idnp' | translate"></erp-shared-search-input>
    </div>
    <div class="col-lg col-12 pt-lg-0 pt-2">
        <erp-shared-search-input (handleSearch)="setFilter('email', $event)"
            [placeholder]="'attach-user-modal.email'  | translate"></erp-shared-search-input>
    </div>
</div>
<div *ngIf="showFilters" class="row">
    <div class="col-lg col-12 pt-lg-0 pt-2">
        <erp-shared-select [items]="departments" (filter)="setFilter('departmentId',  $event)" [placeholder]="'attach-user-modal.search-department' | translate"></erp-shared-select>
    </div>
    <div class="col-lg col-12 pt-lg-0 pt-2">
        <erp-shared-select [items]="roles" (filter)="setFilter('roleId',  $event)" [placeholder]="'attach-user-modal.search-role' | translate"></erp-shared-select>
    </div>
    <div class="col-lg col-12 pt-lg-0 pt-2">
        <erp-shared-select [items]="functions" (filter)="setFilter('functionId',  $event)" [placeholder]="'attach-user-modal.search-function' | translate"></erp-shared-select>
    </div>
    <div class="col-lg col-12 pt-lg-0 pt-2">
        <erp-shared-select [items]="userStatuses" (filter)="setFilter('roleId',  $event)" [placeholder]="'attach-user-modal.search-user-status' | translate"></erp-shared-select>
    </div>
    <div class="d-lg-block d-none col-lg-auto col-12 pt-lg-0 pt-2">
        <app-button (click)="resetFilters()">{{'button.reset-filters' | translate}}</app-button>
    </div>
    <div class="d-lg-none d-block col-lg-auto col-12 pt-lg-0 pt-2">
        <app-button class="w-100" width="100%" (click)="resetFilters()">{{'button.reset-filters' | translate}}</app-button>
    </div>
</div>

<app-loading-spinner *ngIf="isLoading" [contentHeight]="'40vh'" [height]="'5rem'" [width]="'5rem'"
    [colorClass]="'text-primary'">
</app-loading-spinner>

<div class="table-responsive-xl datatable datatable-bordered datatable-head-custom datatable-default datatable-primary datatable-loaded"
id="kt_datatable">
<table class="datatable table font-size-lg" style="overflow: visible" *ngIf="!isLoading">
    <thead class="text-uppercase text-muted">
        <tr>
            <th scope="col" style="width: 50px">
                <span>
                    <label class="checkbox checkbox-lg checkbox-inline" [ngbTooltip]="tooltip">
                        <input type="checkbox" value="" name="option"
                            [checked]="paginatedAttachedIds"
                            (change)="checkAll($event)" />
                        <span></span>
                    </label>
                </span>
            </th>
            <th scope="col"> {{ 'attach-user-modal.last-name' | translate }} ({{ 'attach-user-modal.npp' | translate }}) </th>
            <th scope="col"> {{ 'attach-user-modal.idnp' | translate }} </th>
            <th scope="col"> {{ 'attach-user-modal.email' | translate }} </th>
            <th scope="col"> {{ 'attach-user-modal.department' | translate }} </th>
            <th scope="col"> {{ 'attach-user-modal.role' | translate }} </th>
            <th scope="col"> {{ 'attach-user-modal.function' | translate }} </th>
        </tr>
    </thead>
    <tbody class="datatable-body">
        <tr *ngFor="let user of users">
            <td>
                <label class="checkbox checkbox-lg checkbox-inline">
                    <input #currentCheckbox [type]="inputType" [value]="user.id" name="option"
                        [checked]="attachedUsers.includes(user.id)" (change)="onItemChange($event)" />
                    <span></span>
                </label>
            </td>
            <td> <a class="text-dark-75 text-hover-primary" (click)="currentCheckbox.click()" href="javascript:void(0)">{{ user.lastName }} {{ user.firstName }} {{ user.fatherName }}</a></td>
            <td> {{ user.idnp || '-' }} </td>
            <td> {{ user.email || '-' }} </td>
            <td> {{ user.departmentName || '-' }}</td>
            <td> {{ user.roleName || '-'}}</td>
            <td> {{ user.functionName || '-' }}</td>
        </tr>
    </tbody>
    <tbody class="datatable-body">
        <tr *ngIf="!users.length">
            <td colspan="100" class="text-center">
                {{ 'message.no-record' | translate }}
            </td>
        </tr>
    </tbody>
</table>
<div pagination class="datatable-pager datatable-paging-loaded mb-5" [page]="pagination.currentPage" 
    *ngIf="users" [total]="pagination.totalPages" [totalRecords]="pagination.totalCount" [size]="pagination.pageSize"
    (sizeChange)="getUsers({ page: 1, itemsPerPage: $event})"
    (pageChange)="getUsers({ page: $event, itemsPerPage: pagination.pageSize})">
</div>
</div>
