<div class="mt-3">
    <mat-accordion>
        <mat-expansion-panel [expanded]="true">
            <mat-expansion-panel-header class="p-4">
                <mat-panel-title>
                    <h4 class="m-4">{{'step.MaterialStatus' | translate}}</h4>
                </mat-panel-title>
                <mat-panel-description class="justify-content-end mr-15 p-4">
                    {{ 'step-obligation.obligatory' | translate }}
                </mat-panel-description>
            </mat-expansion-panel-header>
            <form *ngIf="materialStatusForm" class="col mb-md-3 mb-0" [formGroup]="materialStatusForm">
                <app-loading-spinner *ngIf="isLoadingMaterialStatus" contentHeight="20rem" height="5rem" width="5rem"
                    colorClass="text-primary"></app-loading-spinner>
                <div *ngIf="!isLoadingMaterialStatus">
                    <div class="row ml-lg-10 mt-10">
                        <div class="col">
                            <div class="form-group row required">
                                <label class="col-auto col-form-label"
                                    for="materialStatusTypeId">{{'material-status.name' | translate}}</label>
                                <div class="col-lg-4 col-12">
                                    <select class="form-control" formControlName="materialStatusTypeId">
                                        <option value="null">{{'module-access.select' | translate}}</option>
                                        <option *ngFor="let item of materialStatusTypes" [value]="item.value">{{
                                            'materialStatusType.' + item.translateId | translate}}
                                        </option>
                                    </select>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="d-flex justify-content-end mb-3">
                                <button class="btn btn-outline-success" *ngIf="addOrEditMaterialStatusButton"
                                    [disabled]="(materialStatusForm.value.materialStatusTypeId == null) || (materialStatusForm.value.materialStatusTypeId == 'null')"
                                    (click)="updateMaterialStatus()">{{'stepper.button-update' | translate}}</button>
                                <button class="btn btn-outline-success" *ngIf="!addOrEditMaterialStatusButton"
                                    [disabled]="materialStatusForm.value.materialStatusTypeId == null || (materialStatusForm.value.materialStatusTypeId == 'null')"
                                    (click)="createMaterialStatus()">{{'stepper.button-add' | translate}}</button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </mat-expansion-panel>
    </mat-accordion>
    <mat-accordion>
        <mat-expansion-panel>
            <mat-expansion-panel-header class="p-4">
                <mat-panel-title>
                    <h4 class="m-4">{{'material-status.kinship-relation' | translate}}</h4>
                </mat-panel-title>
                <mat-panel-description class="justify-content-end mr-15 p-4">
                    {{ 'step-obligation.optional' | translate }}
                </mat-panel-description>
            </mat-expansion-panel-header>
            <form *ngIf="kinshipRelationWithUserProfileForm" class="col mb-md-3 mb-0"
                [formGroup]="kinshipRelationWithUserProfileForm">
                <app-loading-spinner *ngIf="isLoadingKinshipRelationWithUserProfile" contentHeight="20rem" height="5rem"
                    width="5rem" colorClass="text-primary"></app-loading-spinner>
                <div *ngIf="!isLoadingKinshipRelationWithUserProfile">
                    <div formArrayName="relationWithUserProfile" class="ml-lg-10 ml-0">
                        <table class="table mt-10">
                            <thead>
                                <tr>
                                    <th scope="col">{{ 'table.number' | translate }}</th>
                                    <th scope="col">{{ 'material-status.kinship-degree' | translate }}</th>
                                    <th scope="col">{{ 'material-status.user-name' | translate}}</th>
                                    <th scope="col">{{ 'material-status.last-name' |translate }}</th>
                                    <th scope="col">{{ 'material-status.table-function' | translate}} </th>
                                    <th scope="col">{{ 'material-status.table-subdivision' | translate }}</th>
                                    <th scope="col"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr [ngClass]="{'more': kinshipRelationWithUserProfileForm.controls.relationWithUserProfile.controls.length > 1  &&
                                                (kinshipRelationWithUserProfileForm.controls.relationWithUserProfile.controls.length - 1) !== i}"
                                    *ngFor="let relation of kinshipRelationWithUserProfileForm.controls.relationWithUserProfile.controls; let i = index"
                                    [formGroupName]="i">
                                    <th scope="row">{{i + 1}}</th>
                                    <td>
                                        <select class="form-control" formControlName="kinshipDegree">
                                            <option value="null">{{'module-access.select' | translate}}</option>
                                            <option *ngFor="let item of kinshipDegreeEnum" [value]="item.value">{{
                                                'kinshipDegree.' + item.label | translate}}
                                            </option>
                                        </select>
                                    </td>
                                    <td>
                                        <input formControlName="name" autocomplete="off"
                                            class="form-control form-control-solid" type="text"
                                            [placeholder]="'material-status.user-name' | translate" />
                                    </td>
                                    <td>
                                        <input formControlName="lastName" autocomplete="off"
                                            class="form-control form-control-solid" type="text"
                                            [placeholder]="'material-status.last-name' | translate" />
                                    </td>
                                    <td>
                                        <input formControlName="function" autocomplete="off"
                                            class="form-control form-control-solid" type="text"
                                            [placeholder]="'material-status.table-function' | translate" />
                                    </td>
                                    <td>
                                        <input formControlName="subdivision" autocomplete="off"
                                            class="form-control form-control-solid" type="text"
                                            [placeholder]="'material-status.table-subdivision' | translate" />
                                    </td>
                                    <td>
                                        <div *ngIf="i > 0" class="row justify-content-end mb-3 mr-7">
                                            <button class="btn btn-icon"
                                                (click)="removeKinshipRelationWithUserProfile(i)">
                                                <span class="font-size-18px">&times;</span>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>

                        </table>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="d-flex justify-content-between ml-lg-10 ml-0">
                                <button class="btn btn-icon" (click)="addKinshipRelationWithUserProfile()"><span
                                        class="font-size-18px">+</span></button>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="d-flex justify-content-end mb-3 mt-lg-0 mt-3">
                                <button class="btn btn-success" *ngIf="addOrEditKinshipRelationWithUserProfileButton"
                                    [disabled]="kinshipRelationWithUserProfileForm && kinshipRelationWithUserProfileForm.invalid "
                                    (click)="creteKinshipRelationWithUserProfile()">{{'stepper.button-update' |
                                    translate}}</button>
                                <button class="btn btn-outline-success"
                                    *ngIf="!addOrEditKinshipRelationWithUserProfileButton"
                                    [disabled]="kinshipRelationWithUserProfileForm && kinshipRelationWithUserProfileForm.invalid"
                                    (click)="creteKinshipRelationWithUserProfile()">{{'stepper.button-add' |
                                    translate}}</button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </mat-expansion-panel>
    </mat-accordion>
    <mat-accordion>
        <mat-expansion-panel>
            <mat-expansion-panel-header class="p-4">
                <mat-panel-title>
                    <h4 class="m-4">{{'material-status.biography-data' | translate}}</h4>
                </mat-panel-title>
                <mat-panel-description class="justify-content-end mr-15 p-4">
                    {{ 'step-obligation.optional' | translate }}
                </mat-panel-description>
            </mat-expansion-panel-header>
            <form *ngIf="kinshipRelationForm" class="col mb-md-3 mb-0" [formGroup]="kinshipRelationForm">
                <app-loading-spinner *ngIf="isLoadingKinshipRelation" contentHeight="20rem" height="5rem" width="5rem"
                    colorClass="text-primary"></app-loading-spinner>
                <div *ngIf="!isLoadingKinshipRelation">
                    <div formArrayName="relation" class="ml-lg-10 ml-0">
                        <table class="table table-bordered border-dark mb-10" [ngClass]="{'more': kinshipRelationForm.controls.relation.controls.length > 1  &&
                        (kinshipRelationForm.controls.relation.controls.length - 1) !== i}"
                            *ngFor="let relation of kinshipRelationForm.controls.relation.controls; let i = index"
                            [formGroupName]="i">
                            <tbody>
                                <tr>
                                    <th>{{ 'table.number' | translate}}</th>
                                    <td>
                                        {{i + 1}}
                                    </td>
                                </tr>
                                <tr>
                                    <th>{{ 'material-status.kinship-degree' | translate }} </th>
                                    <td>
                                        <select class="form-control" formControlName="kinshipDegree">
                                            <option value="null">{{'module-access.select' | translate}}</option>
                                            <option *ngFor="let item of kinshipDegreeEnum" [value]="item.value">{{
                                                'kinshipDegree.' + item.label | translate}}
                                            </option>
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <th>{{'material-status.user-name' | translate}}</th>
                                    <td>
                                        <input formControlName="name" autocomplete="off"
                                            class="form-control form-control-solid" type="text"
                                            [placeholder]="'material-status.user-name' | translate" />
                                    </td>
                                </tr>
                                <tr>
                                    <th>{{'material-status.last-name' | translate}}</th>
                                    <td>
                                        <input formControlName="lastName" autocomplete="off"
                                            class="form-control form-control-solid" type="text"
                                            [placeholder]="'material-status.last-name' | translate" />
                                    </td>
                                </tr>
                                <tr>
                                    <th>{{ 'material-status.birthday-date' | translate}}</th>
                                    <td>
                                        <app-date [parent]="relation" [date]="'birthDate'"
                                            [placeholder]="'material-status.birthday-date' | translate"></app-date>
                                    </td>
                                </tr>
                                <tr>
                                    <th>{{'material-status.birth-place' | translate}}</th>
                                    <td>
                                        <input formControlName="birthLocation" autocomplete="off"
                                            class="form-control form-control-solid" type="text"
                                            [placeholder]="'material-status.birth-place' | translate" />
                                    </td>
                                </tr>
                                <tr>
                                    <th>{{ 'material-status.table-function' | translate }}</th>
                                    <td>
                                        <input formControlName="function" autocomplete="off"
                                            class="form-control form-control-solid" type="text"
                                            [placeholder]="'material-status.table-function' | translate" />
                                    </td>
                                </tr>
                                <tr>
                                    <th>{{ 'material-status.work-place' | translate}}</th>
                                    <td>
                                        <input formControlName="workLocation" autocomplete="off"
                                            class="form-control form-control-solid" type="text"
                                            [placeholder]="'material-status.work-place' | translate" />
                                    </td>
                                </tr>
                                <tr>
                                    <th>{{ 'material-status.residence' | translate}}</th>
                                    <td>
                                        <input formControlName="residenceAddress" autocomplete="off"
                                            class="form-control form-control-solid" type="text"
                                            [placeholder]="'material-status.residence' | translate" />
                                    </td>
                                </tr>
                                <tr *ngIf="i > 0">
                                    <th></th>
                                    <td>
                                        <div class="justify-content-end">
                                            <button class="btn btn-icon" (click)="removeKinshipRelation(i)">
                                                <span class="font-size-18px">&times;</span>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="d-flex justify-content-between ml-lg-10 ml-0">
                                <button class="btn btn-icon" (click)="addKinshipRelation()"><span
                                        class="font-size-18px">+</span></button>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="d-flex justify-content-end mb-3 mt-lg-0 mt-3 ml-md-10 ml-0">
                                <button class="btn btn-success" *ngIf="addOrEditKinshipRelationButton"
                                    [disabled]="kinshipRelationForm && kinshipRelationForm.invalid "
                                    (click)="creteKinshipRelation()">{{'stepper.button-update' | translate}}</button>
                                <button class="btn btn-outline-success" *ngIf="!addOrEditKinshipRelationButton"
                                    [disabled]="kinshipRelationForm && kinshipRelationForm.invalid"
                                    (click)="creteKinshipRelation()">{{'stepper.button-add' | translate}}</button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </mat-expansion-panel>
    </mat-accordion>
    <mat-accordion>
        <mat-expansion-panel>
            <mat-expansion-panel-header class="p-4">
                <mat-panel-title>
                    <h4 class="m-4">{{'material-status.kinship-criminal-data-name' | translate}}</h4>
                </mat-panel-title>
                <mat-panel-description class="justify-content-end mr-15 p-4">
                    {{ 'step-obligation.optional' | translate }}
                </mat-panel-description>
            </mat-expansion-panel-header>
            <form *ngIf="kinshipRelationCriminalDataForm" class="col mb-md-3 mb-0"
                [formGroup]="kinshipRelationCriminalDataForm">
                <app-loading-spinner *ngIf="isLoadingKinshipRelationCriminalData" contentHeight="20rem" height="5rem"
                    width="5rem" colorClass="text-primary"></app-loading-spinner>
                <div *ngIf="!isLoadingKinshipRelationCriminalData">
                    <div class="row mx-md-10 mx-0 mt-10">
                        <ckeditor [editor]="Editor" class="w-100" name="editor1" skin="moono-lisa" language="en"
                            formControlName="text" (ready)="onReady($event)"></ckeditor>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="d-flex justify-content-end mb-3">
                                <button class="btn btn-success" *ngIf="addOrEditKinshipRelationCriminalDataButton"
                                    [disabled]="kinshipRelationCriminalDataForm.value.text == null || kinshipRelationCriminalDataForm.value.text == '' "
                                    (click)="updateKinshipRelationCriminalData()">{{'stepper.button-update' |
                                    translate}}</button>
                                <button class="btn btn-outline-success"
                                    *ngIf="!addOrEditKinshipRelationCriminalDataButton"
                                    [disabled]="kinshipRelationCriminalDataForm.value.text == null || kinshipRelationCriminalDataForm.value.text == '' "
                                    (click)="createKinshipRelationCriminalData()">{{'stepper.button-add' |
                                    translate}}</button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </mat-expansion-panel>
    </mat-accordion>
    <div class="row">
        <div class="col">
            <div class="col-xl-none col-lg-none col d-flex justify-content-end mt-3 mr-1">
                <button class="btn btn-success" matStepperNext
                    [disabled]="(materialStatusForm && materialStatusForm.invalid || userMaterialStatus == null)"
                    (click)="addRegistrationFluxStep()">{{'stepper.button-next' | translate}}</button>
            </div>
        </div>
    </div>
</div>